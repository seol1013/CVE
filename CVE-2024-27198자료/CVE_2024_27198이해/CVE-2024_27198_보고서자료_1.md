아래 내용은 **CVE-2022-22965 (Spring4Shell)** 를 “취약점 분석가” 관점에서 정리한 분석 보고서 형태입니다. (참고: 대화에 첨부된 PDF 는 JetBrains 제품 보안 수정 목록으로 보이며, Spring4Shell(CVE-2022-22965) 분석 근거 문서로는 직접 활용되지 않습니다.)

---

## 1) 영향을 받는 소프트웨어 버전 (Affected Versions)

### 핵심 영향 범위(프레임워크/런타임 조건)

- **Spring Framework (Spring MVC / Spring WebFlux)** 가 **JDK 9 이상**에서 동작하는 경우, 특정 조건에서 **데이터 바인딩(data binding)** 을 통해 **RCE(원격 코드 실행)** 로 이어질 수 있습니다. ([Home](https://spring.io/security/cve-2022-22965?utm_source=chatgpt.com "CVE-2022-22965: Spring Framework RCE via Data Binding ..."))
    
- 공개 당시 Spring 측에서 수정 버전으로 **Spring Framework 5.3.18, 5.2.20** 을 안내했습니다. ([Home](https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement?utm_source=chatgpt.com "Spring Framework RCE, Early Announcement"))
    

### “취약해지기 쉬운” 대표 조건(실무에서 중요)

Spring 측 공개 기준으로, 널리 알려진 공격 시나리오(웹셸 드롭)는 대체로 아래 조건을 만족할 때 성립합니다.

- **JDK 9+**
    
- **Apache Tomcat**
    
- **WAR 배포(전통적인 WAR로 Tomcat에 배포)**
    
- 그리고 **Spring MVC/WebFlux의 데이터 바인딩이 동작하는 요청 처리 경로 존재** ([Home](https://spring.io/security/cve-2022-22965?utm_source=chatgpt.com "CVE-2022-22965: Spring Framework RCE via Data Binding ..."))
    

> 참고: Spring Boot의 “기본 배포 방식”인 **실행형 JAR** 는 널리 알려진 Tomcat+WAR 기반 웹셸 체인에는 보통 해당되지 않는 것으로 안내됐습니다. 다만 취약점의 성격상 다른 악용 경로 가능성은 언급됩니다. ([Home](https://spring.io/security/cve-2022-22965?utm_source=chatgpt.com "CVE-2022-22965: Spring Framework RCE via Data Binding ..."))

### 취약 버전 범위(업데이트 권고 관점)

- 국내 공지(Boho) 기준으로는 **Spring Framework 5.3.0~5.3.17, 5.2.0~5.2.19 및 이전 버전**이 영향 가능, **5.3.18 / 5.2.20으로 업데이트 권고**로 정리되어 있습니다. ([boho.or.kr](https://www.boho.or.kr/kr/bbs/view.do?bbsId=B0000133&categoryCode=&menuNo=205020&nttId=66592&pageIndex=1&searchCnd=1&searchWrd=At&utm_source=chatgpt.com "Spring Java 프레임워크 보안 업데이트 권고(CVE-2022- ..."))
    

---

## 2) 공격 매커니즘 (Attack Mechanism) — 단계별 상세(개념 중심)

> 안전상 이유로, 실제 “악용 가능한 요청 파라미터 이름/값(웹셸 패턴/경로 등)”을 그대로 재현하는 페이로드는 제공하지 않습니다. 대신 **공격이 성립하는 내부 동작**을 단계별로 해부하고, 각 단계에서 무엇을 막아야 하는지까지 연결해 설명합니다.

### 배경: Spring의 “데이터 바인딩”이란?

Spring MVC/WebFlux에서는 요청 파라미터를 **POJO(자바 객체) 필드에 자동 매핑**하는 패턴이 흔합니다. 예를 들어:

- 컨트롤러가 `@RequestMapping` 같은 매핑을 가지고,
    
- 메서드 인자로 `UserForm form` 같은 객체를 받으면,
    
- 요청 파라미터 `name=...&age=...` 가 객체의 setter/필드로 바인딩됩니다. ([Microsoft](https://www.microsoft.com/en-us/security/blog/2022/04/04/springshell-rce-vulnerability-guidance-for-protecting-against-and-detecting-cve-2022-22965/?utm_source=chatgpt.com "SpringShell RCE vulnerability: Guidance for protecting ..."))
    

이 자동화가 편리하지만, **“바인딩 경로가 어디까지 확장될 수 있는가”**가 보안 경계가 됩니다.

---

### 단계 1: 공격 표면 식별 (Entry Point 확보)

공격자는 다음과 같은 엔드포인트를 노립니다.

- 외부 입력(쿼리스트링/폼/멀티파트 등)을 받아
    
- **POJO 파라미터 바인딩이 발생**하고
    
- 바인딩 제한(허용 필드 화이트리스트/블랙리스트)이 촘촘하지 않은 곳 ([Microsoft](https://www.microsoft.com/en-us/security/blog/2022/04/04/springshell-rce-vulnerability-guidance-for-protecting-against-and-detecting-cve-2022-22965/?utm_source=chatgpt.com "SpringShell RCE vulnerability: Guidance for protecting ..."))
    

**예시(안전한 예시):**

- `/user/update` 가 `UserProfileForm` 을 받아 업데이트하는 구조
    
- `/search` 가 `SearchFilter` 객체로 필터를 받는 구조  
    → 이런 곳은 “자동 바인딩”이 개입할 확률이 높습니다.
    

---

### 단계 2: “비정상적 바인딩 경로”로 객체 그래프(Object Graph) 확장 시도

정상 바인딩은 `form.name`, `form.email` 같은 단순 필드로 끝나야 합니다.  
하지만 취약 시나리오에서는, 공격 입력이 **예상보다 깊은 경로**(중첩 속성 체인)를 타고 들어가며, 애플리케이션이 의도하지 않은 내부 객체(프레임워크/서블릿 컨테이너 관련 객체)에 영향을 주도록 유도합니다. ([Home](https://spring.io/security/cve-2022-22965?utm_source=chatgpt.com "CVE-2022-22965: Spring Framework RCE via Data Binding ..."))

핵심 포인트:

- “사용자 입력 → 데이터 바인더 → 내부 객체 속성 변경”이 가능해지면
    
- 이후 단계에서 **서버 측 파일 쓰기/설정 변경** 같은 위험 동작으로 연결됩니다.
    

---

### 단계 3: Tomcat(WAR) 환경에서 “서버 측 파일 쓰기”로 연결되는 조건 형성

Spring의 공식 설명에서 널리 알려진 공격 체인은 **Tomcat + WAR 배포**에 강하게 묶여 있습니다. ([Home](https://spring.io/security/cve-2022-22965?utm_source=chatgpt.com "CVE-2022-22965: Spring Framework RCE via Data Binding ..."))  
이 조합이 중요한 이유는:

- Tomcat은 JSP/리소스 로딩, 로그/파이프라인(밸브) 구성 등 “컨테이너 내부 설정”이 실제 파일/리소스 처리와 연결되는 지점이 있고,
    
- 특정 속성이 변조되면 **서버가 특정 위치에 “공격자가 통제하는 내용”을 기록**하게 만들 여지가 생깁니다. ([Home](https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement?utm_source=chatgpt.com "Spring Framework RCE, Early Announcement"))
    

(여기서 흔히 말하는 결과물이 “웹셸” 같은 서버측 실행 가능한 파일이지만, 구체 페이로드는 생략합니다.)

---

### 단계 4: 악성 산출물(예: 웹셸) 업로드/생성 → HTTP로 실행(RCE)

조건이 맞아떨어지면 공격자는 다음 흐름을 달성합니다.

1. 입력 바인딩으로 “쓰기 동작”이 유발되도록 컨테이너 동작을 비정상 상태로 만듦
    
2. 서버가 공격자 통제 문자열을 파일로 기록
    
3. 공격자가 해당 파일을 HTTP로 호출해 서버에서 코드 실행
    

실제로 이 취약점은 공개 직후 **실제 악용(봇넷 등) 관측** 보고가 있었습니다. ([www.trendmicro.com](https://www.trendmicro.com/en_us/research/22/d/cve-2022-22965-analyzing-the-exploitation-of-spring4shell-vulner.html?utm_source=chatgpt.com "CVE-2022-22965 Analyzing the Exploitation of ..."))

---

## 3) 취약점 분석 (Root Cause & Why it Works)

### 3.1 근본 원인: “바인딩 경계”가 충분히 강제되지 않을 때의 객체 그래프 오염

CVE-2022-22965는 요약하면:

- Spring MVC/WebFlux의 **데이터 바인딩 기능**
    
- - 특정 런타임(JDK 9+) 및 배포/컨테이너 조건
        
- - Tomcat(WAR)에서 관찰된 “쓰기/실행 연결고리”  
        가 결합되어, **원래 애플리케이션이 허용하려던 입력 범위를 넘어서는 속성 변경**이 발생할 수 있는 문제로 정리됩니다. ([Home](https://spring.io/security/cve-2022-22965?utm_source=chatgpt.com "CVE-2022-22965: Spring Framework RCE via Data Binding ..."))
        

### 3.2 왜 JDK 9+ 조건이 붙나?

Spring 및 다수 분석 글에서는 **JDK 9 이상에서의 클래스 로딩/리플렉션/모듈 관련 조건**이 알려진 공격 체인 성립에 중요한 전제라고 설명합니다. ([Home](https://spring.io/security/cve-2022-22965?utm_source=chatgpt.com "CVE-2022-22965: Spring Framework RCE via Data Binding ..."))

### 3.3 “Tomcat + WAR”가 왜 핵심인가?

Spring 공식 안내에서 “특정 익스플로잇은 Tomcat 상의 WAR 배포가 필요”하다고 명시합니다. ([Home](https://spring.io/security/cve-2022-22965?utm_source=chatgpt.com "CVE-2022-22965: Spring Framework RCE via Data Binding ..."))  
또한 Spring 측 초기 공지에서는 Tomcat이 **공격 벡터를 닫는 방향의 버전 업데이트**를 배포했다는 언급도 있습니다. ([Home](https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement?utm_source=chatgpt.com "Spring Framework RCE, Early Announcement"))

---

## (실무용) 영향/리스크 요약 & 대응 포인트

### 영향

- 조건 충족 시 **원격 코드 실행(RCE)** 가능 ([Home](https://spring.io/security/cve-2022-22965?utm_source=chatgpt.com "CVE-2022-22965: Spring Framework RCE via Data Binding ..."))
    
- 공개 직후부터 실제 악용 정황이 보고됨(위협 행위자/봇넷 등) ([www.trendmicro.com](https://www.trendmicro.com/en_us/research/22/d/cve-2022-22965-analyzing-the-exploitation-of-spring4shell-vulner.html?utm_source=chatgpt.com "CVE-2022-22965 Analyzing the Exploitation of ..."))
    

### 우선 대응(권고)

- Spring Framework를 **5.3.18 / 5.2.20 이상**으로 업데이트 ([Home](https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement?utm_source=chatgpt.com "Spring Framework RCE, Early Announcement"))
    
- Tomcat도 Spring 측 언급 버전(예: 9.0.62 / 10.0.20 / 8.5.78 등)처럼 **공격 벡터 완화가 반영된 버전** 검토 ([Home](https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement?utm_source=chatgpt.com "Spring Framework RCE, Early Announcement"))
    
- 앱 레벨에서:
    
    - 데이터 바인딩 대상 필드 **화이트리스트** 적용
        
    - 위험한 중첩 바인딩 차단(허용 경로 제한)
        
    - 외부 입력으로 “프레임워크/컨테이너 내부 객체”까지 닿지 않게 설계 점검
        

---

